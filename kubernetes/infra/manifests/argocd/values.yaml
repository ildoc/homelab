gateway:
  enabled: true
  name: cilium-gateway
  namespace: kube-system
  hostname: argocd.local.ildoc.it

argo-cd:
  global:
    domain: argocd.local.ildoc.it

  redis-ha:
    enabled: true
    haproxy:
      enabled: true

  controller:
    replicas: 1  # StatefulSet mode

  server:
    replicas: 2  # HA recommended
    ingress:
      enabled: false

  repoServer:
    replicas: 2

  applicationSet:
    replicas: 2

  configs:
    cm:
      timeout.reconciliation: 180s
      # Health check per le EndpointSlices
      resource.customizations.health.discovery.k8s.io_EndpointSlice: |
        hs = {}
        hs.status = "Healthy"
        hs.message = "EndpointSlice is present"
        return hs
      
    params:
      server.insecure: "true"
      application.resourceTrackingMethod: "annotation"
    
    # Inclusione ristretta solo al namespace external-routes
    resource.inclusions: |
      - apiGroups:
        - discovery.k8s.io
        kinds:
        - EndpointSlice
        clusters:
        - '*'
        namespaces:
        - external-routes
