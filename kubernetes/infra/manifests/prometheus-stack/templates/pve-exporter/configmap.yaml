{{- if .Values.monitoring.pveExporter.enabled }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: pve-exporter-config
  namespace: monitoring
data:
  pve.yml: |
    default:
      user: "{{ .Values.monitoring.pveExporter.user }}"
      password: "{{ .Values.monitoring.pveExporter.password }}"
      verify_ssl: {{ .Values.monitoring.pveExporter.verifySsl | default false }}
      {{- if .Values.monitoring.pveExporter.targets }}
      targets:
        {{- range .Values.monitoring.pveExporter.targets }}
        - "{{ . }}"  # IP dei nodi Proxmox
        {{- end }}
      {{- end }}
{{- end }}
