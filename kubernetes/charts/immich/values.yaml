immich:
  # Configurazione condivisa tra tutti i componenti Immich
  controllers:
    main:
      containers:
        main:
          env:
            # Configurazione database PostgreSQL esterno
            DB_HOSTNAME: "192.168.0.30"
            DB_PORT: "5432"
            DB_DATABASE_NAME: "immich"
            DB_USERNAME: "immich_user"
            # La password viene iniettata tramite ExternalSecret tramite extraEnv
          # extraEnv va dentro containers.main secondo la bjw-s common library
          extraEnv:
            - name: DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: immich-db-secret
                  key: DB_PASSWORD

  immich:
    persistence:
      # Main data store per tutte le foto condiviso tra i diversi componenti
      # Usa il PVC creato dal template che monta la share NFS
      library:
        existingClaim: "immich-library-pvc"

  # Componenti Immich
  server:
    enabled: true
    ingress:
      main:
        enabled: false

  # Abilita Valkey (Redis) incluso nel chart - necessario per Immich
  valkey:
    enabled: true

# Configurazione HTTPRoute (template del wrapper)
httproute:
  hostname: "immich.local.ildoc.it"
  serviceName: ""  # Lascia vuoto per usare il pattern {release-name}-server, altrimenti specifica il nome

# Configurazione volumi NFS (template del wrapper)
# Aggiungi qui tutte le cartelle NFS che vuoi montare
# Ogni volume creerà automaticamente un PV e un PVC
# NOTA: La size è opzionale per NFS e NON è limitante
#       Kubernetes richiede questo campo ma NON applica alcun limite reale
#       La capacità disponibile è quella del server NFS, anche se specifichi 1Gi
nfsVolumes:
  - name: library
    pvc: "immich-library-pvc"
    server: "192.168.0.123"
    path: "/mnt/data/foto"
    # size: 100Gi  # Opzionale - solo formale per NFS
  # - name: backup
  #   pvc: "immich-backup-pvc"
  #   server: "192.168.0.123"
  #   path: "/mnt/data/backup/Telefono/Fotocamera"
    # size: 100Gi  # Opzionale - solo formale per NFS
