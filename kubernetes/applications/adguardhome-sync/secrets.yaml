---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: vault-adguardhome-sync-secrets
  namespace: apps
spec:
  refreshInterval: "1h"
  secretStoreRef:
    name: vault-kubernetes-secret-store
    kind: ClusterSecretStore
  target:
    name: adguardhome-sync-secrets
    creationPolicy: Owner
  data:
  # Origin (Primary) instance
  - secretKey: origin_url
    remoteRef:
      key: kubernetes/data/apps/adguardhome-sync
      property: origin_url
  - secretKey: origin_username
    remoteRef:
      key: kubernetes/data/apps/adguardhome-sync
      property: origin_username
  - secretKey: origin_password
    remoteRef:
      key: kubernetes/data/apps/adguardhome-sync
      property: origin_password
  
  # Replica 1 instance
  - secretKey: replica1_url
    remoteRef:
      key: kubernetes/data/apps/adguardhome-sync
      property: replica1_url
  - secretKey: replica1_username
    remoteRef:
      key: kubernetes/data/apps/adguardhome-sync
      property: replica1_username
  - secretKey: replica1_password
    remoteRef:
      key: kubernetes/data/apps/adguardhome-sync
      property: replica1_password
  
  # Optional: Replica 2 instance
  # - secretKey: replica2_url
  #   remoteRef:
  #     key: kubernetes/data/apps/adguardhome-sync
  #     property: replica2_url
  # - secretKey: replica2_username
  #   remoteRef:
  #     key: kubernetes/data/apps/adguardhome-sync
  #     property: replica2_username
  # - secretKey: replica2_password
  #   remoteRef:
  #     key: kubernetes/data/apps/adguardhome-sync
  #     property: replica2_password